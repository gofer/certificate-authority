openssl genrsa \
  -out apps.localdomain.private_key.pem \
  -aes-256-cbc \
  4096


openssl req -new -utf8 \
  -subj '/C=JP/CN=apps.localdomain' \
  -addext 'subjectAltName = DNS:apps.localdomain,DNS:app1.apps.localdomain' \
  -key ./apps.localdomain.private_key.pem \
  -out apps.localdomain.csr


openssl req -noout -text -in apps.localdomain.csr


openssl ca \
  -config conf/openssl.cfg \
  -section CA_inter \
  -extensions v3_inter_ca_for_servers \
  -md sha256 \
  -days 366 \
  -in apps.localdomain.csr \
  -out apps.localdomain.crt


openssl crl2pkcs7 \
  -nocrl \
  -certfile ../root_ca/certs/root_ca.crt \
  -certfile ../inter_ca/certs/inter_ca.crt \
  -certfile ./apps.localdomain.crt \
  -out chain.p7b


openssl crl2pkcs7 \
  -nocrl \
  -certfile ../root_ca/certs/root_ca.crt \
  -certfile ../inter_ca/certs/inter_ca.crt \
  -out ca_chain.p7b


openssl ca \
  -gencrl \
  -md sha256 \
  -config "conf/openssl.cfg" \
  -section CA_root \
  -extensions v3_root_ca \
  -out root.crl


openssl ca \
  -gencrl \
  -md sha256 \
  -config "conf/openssl.cfg" \
  -section CA_inter \
  -extensions v3_inter_ca \
  -out intermediate.crl

